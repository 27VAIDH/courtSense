# Ralph Progress Log
Started: Sun Feb  8 15:49:01 IST 2026
---

## Codebase Patterns
- Supabase client initialized in src/lib/supabase.ts with environment variable validation
- Database schema uses RLS policies with auth.uid() = user_id pattern for all user-scoped tables
- All sync-enabled tables include last_modified_ms BIGINT for conflict resolution
- Storage bucket pattern: {userId}/{matchId}_{timestamp}.jpg for user-specific uploads

---

## 2026-02-08 15:54:32 - US-P001
- **What was implemented:**
  - Installed Supabase dependencies (@supabase/supabase-js, @supabase/auth-helpers-react)
  - Created Supabase client configuration in src/lib/supabase.ts
  - Created comprehensive database schema SQL file (src/db/supabase-schema.sql) with:
    * Core tables: user_profiles, players, venues, matches, games, rally_analyses
    * Social tables: friendships, groups, group_members, leaderboard_cache, activity_log
    * RLS policies on all tables enforcing auth.uid() = user_id
    * Performance indexes on critical query paths
    * Storage bucket (match-photos) with RLS for photo uploads
  - Created .env.local template with setup instructions (not committed)
  - Created README-SUPABASE.md with comprehensive setup guide

- **Files changed:**
  - package.json, package-lock.json (added Supabase dependencies)
  - src/lib/supabase.ts (new - Supabase client with TypeScript types)
  - src/db/supabase-schema.sql (new - complete database schema)
  - .env.local (new - template, gitignored)
  - README-SUPABASE.md (new - setup guide)

- **Learnings for future iterations:**
  - Pattern: @supabase/auth-helpers-react is deprecated (warning shown), but still functional for MVP. Consider migrating to newer auth patterns in future iterations.
  - Pattern: Environment variable validation in supabase.ts logs warning if variables missing, preventing silent failures
  - Pattern: Database schema includes groups/leaderboards tables early to avoid migrations later
  - Gotcha: .env.local should NEVER be committed (already in .gitignore via *.local pattern)
  - Context: Schema SQL file is meant to be run manually in Supabase SQL Editor - not auto-applied
  - Context: Storage bucket RLS uses storage.foldername(name)[1] pattern to extract userId from path

---
